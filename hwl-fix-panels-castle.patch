diff --git a/Assets/scripts/CastleUpgradeUI.cs b/Assets/scripts/CastleUpgradeUI.cs
index 04fd6e8..7493ab7 100644
--- a/Assets/scripts/CastleUpgradeUI.cs
+++ b/Assets/scripts/CastleUpgradeUI.cs
@@ -17,6 +17,7 @@ public class CastleUpgradeUI : MonoBehaviour
 
         if (upgradeButton != null)
         {
+            upgradeButton.onClick.RemoveAllListeners();
             upgradeButton.onClick.AddListener(TryUpgrade);
         }
 
@@ -40,10 +41,13 @@ public class CastleUpgradeUI : MonoBehaviour
 
         int cost = castle.GetUpgradeCost();
 
+        if (cost <= 0) return;
+
         if (GameManager.Instance.gold >= cost)
         {
             // Списуємо гроші
-            GameManager.Instance.AddResource(ResourceType.Gold, -cost); // Мінус золото
+            GameManager.Instance.gold -= cost;
+            GameManager.Instance.UpdateUI();
             
             // Покращуємо замок
             castle.UpgradeCastle();
diff --git a/Assets/scripts/GameManager.cs b/Assets/scripts/GameManager.cs
index 94337a4..6dfef14 100644
--- a/Assets/scripts/GameManager.cs
+++ b/Assets/scripts/GameManager.cs
@@ -282,6 +282,7 @@ public class GameManager : MonoBehaviour
     void Start()
     {
         SetupAllButtons(); 
+        ResolvePanelRefs();
         CacheNewPanelsUI();
         if (autoWirePanels) WirePanelButtons();
         if (logUnwiredButtons) LogUnwiredButtons();
@@ -1364,6 +1365,26 @@ public class GameManager : MonoBehaviour
         CollectPanelUI(settingsPanelNew, out settingsPanelButtons, out settingsPanelTexts);
     }
 
+    void ResolvePanelRefs()
+    {
+        // Якщо в інспекторі посилання на prefab asset, підміняємо на scene instance з ієрархії
+        constructionPanel = ResolvePanel(constructionPanel, "ConstructionPanel_New");
+        barracksUpgradePanel = ResolvePanel(barracksUpgradePanel, "BarracksPanel_New");
+        shopPanel = ResolvePanel(shopPanel, "ForgePanel_New");
+
+        constructionPanelNew = ResolvePanel(constructionPanelNew, "ConstructionPanel_New");
+        barracksPanelNew = ResolvePanel(barracksPanelNew, "BarracksPanel_New");
+        shopPanelNew = ResolvePanel(shopPanelNew, "ForgePanel_New");
+        settingsPanelNew = ResolvePanel(settingsPanelNew, "SettingsPanel_New");
+    }
+
+    GameObject ResolvePanel(GameObject current, string name)
+    {
+        if (current != null && current.scene.IsValid()) return current;
+        var go = GameObject.Find(name);
+        return go != null ? go : current;
+    }
+
     void CollectPanelUI(GameObject panel, out Button[] buttons, out TMP_Text[] texts)
     {
         if (panel == null)
